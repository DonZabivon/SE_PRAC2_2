;
; Программа вычисления факториала.
; Вводит число с клавиатуры, вычисляет факториал,
; и выводит результат на экран.
; Допустимый ввод: числа в диапазоне [1 - 12],
; при больших числах результат не помещается в 32 бита.
;
    BEGIN

    ; Ввод числа
    IN
    POPR R0

    PUSHR R0
    POPR R255   ; Результат в R255
    PUSHR R0    ; В R0 текущий множитель
L1:
    ; Проверка условия выхода (множитель равен 1)
    ; Текущий множитель на вершине стека
    PUSH 1
    JEQ EXIT
L2:
    ; Вычесть из множителя 1
    PUSH 1
    PUSHR R0
    SUB

    ; Сохранить текущий множитель в R0
    POPR R0
    PUSHR R0    

    ; Умножить текущий множитель на текущий результат
    PUSHR R255
    MUL

    ; Сохранить текущий результат в R255
    POPR R255
    ; Положить текущий множитель на стек
    PUSHR R0

    ; Перейти в начало цикла
    JMP L1
EXIT:
    ; Извлечь результат из регистра
    PUSHR R255
    ; Вывести на экран
    OUT
    END